# Detection-of-Epilepsy-using-CNN

## Abstract
The problem of epilepsy has grown exponentially and is now considered as one of the most  prevailing neurological disorders affecting around 50 million people around the globe. Epilepsy is  identified by analyzing the interictal activity present in the EEG signal. Visual analysis of EEG is  a tedious process and subject to human error. This work proposes a robust method to ease the  burden of intractable seizures by automatic recognition of ictal epileptiform activity in the EEG of  epileptic patients. The classification between EEG having an epileptic seizure and non-seizure is  done using various machine learning algorithms. The classifiers used are weighted KNN, Boosted  Trees, Bagged Trees, subspace discrimination, Subspace KNN and RUS boosted tree. Based on  the accuracy of the classifier we will select one method and we will export the model as function  to use for validation purpose. These are the methods used to classify epileptic seizure EEG signals. 

## INTRODUCTION 
This Chapter gives the information about the introduction of Epilepsy and its detection, and the 
methods used to detect Epilepsy. It also gives some information about the present proposed method 
for the detection of Epilepsy. Epilepsy is a chronic disorder that causes unprovoked, recurrent 
seizures. A seizure is a sudden rush of electrical activity in the brain. There are two main types of 
seizures. Generalized seizures affect the whole brain. Focal, or partial seizures, affect just one part 
of the brain. The electroencephalogram (EEG) is a dynamic non- invasive and relatively 
inexpensive technique used to monitor the state of the brain. An EEG signal recorded with 
electrodes placed on the scalp consists of many waves with different characteristics. Arrays of 
electrodes are distributed over the entire scalp. 
 Electroencephalogram is a way through which we can retrieve information regarding the 
physiological situation of a patient. EEG is a non-invasive testing method which contains a lot of 
information about the state of a patient’s health. Through EEG, complicated dynamics of brain can 
be comprehended. EEG signals are very essential for detecting disorders like epilepsy seizures. 
The World Health Organization has stated in a report that more that 50 million people world-wide 
suffer from epilepsy. Manual detection of epileptic seizures is an extremely time-consuming and 
laborious task, and it is also subject to the expertise of the neurologist. Accurate and timely 
diagnosis is extremely important so that patients can start with the treatment procedure as early as 
possible. 
 Epileptic seizures are caused by disruption in the neuron firing mechanism that is abnormalities in 
the electrical signals generated by the brain. Since electroencephalogram (EEG) signals record the 
electrical activity of the brain, hence it is natural to use these signals for the task of detecting 
epileptic seizures. Lot of research in the domain of analysis of EEG and it’s classification is based 
upon the fact that processing of information in the brain is exhibited in the EEG signals as the 
transitions of electrical- activity in time and frequency dynamically. Hence, wavelet transforms are 
very effectively used for capturing the smallest of these transitions in the EEG signals.

## Overview: 
Analysis of EEG signals is usually not an easy task, due to their non-linear and non-stationary 
nature. Therefore, automated ways are being developed extensively for the purpose of detection of 
epilepsy seizures. Discrete Wavelet Transform (DWT) is an appropriate tool for dealing with such 
signals since it localizes the signal in both the time and the frequency domains. That is why it is 
preferred over some other methods like Fourier Transform which do not provide temporal 
resolution.
## Motivation: 
Epilepsy is a disorder in which nerve cell activity in the brain is disturbed, causing seizures. Since 
brain is our most important part in the body we have to protect it well. Therefore we are motivated 
to detect a neural disorder and with that we can diagnose it as early as possible. Epilepsy affects 
more than 2% people worldwide of which developing countries are affected worse. A seizure is a 
transient irregularity in the brain’s electrical activity that produces disturbing physical symptoms 
such as a lapse in attention and memory, a sensory illusion, etc. Approximately one out of every 
three patients have frequent seizures, despite treatment with multiple anti-epileptic drugs. According 
to a survey, population aged 65 or above in European Union is predicted to rise from 16.4% (2004) 
to 29.9% (2050) and also this tremendous increase in aged population is also predicted for other 
countries by 2050. Because of all the above-mentioned scenarios we are motivated to do this project. 
## Problem Statement: 
Epilepsy is a neurological disorder which causes abnormal brain activity such as seizures. 
Electroencephalogram (EEG) signals are recordings of the electrical activity of brain, which are 
used extensively in many medical applications, including detection of epileptic seizures. 
Traditionally, neurologists made inferences by visual inspection. However, this was usually very 
time consuming and the results are subject to the expertise of the reader. Hence, automatic epileptic 
seizure detection techniques are needed, which are able to provide high quality results in a short 
time. 

## Objectives: 
- Collection of data set of EEG Signals from The Bonn University Dataset. 
- Developing an algorithm to convert EEG Signals from time domain to frequency domain 
using Discrete Wavelet Transform. 
- Developing an algorithm for the appropriate extraction of features and classification 
using SVM and CNN. 
- Results should be in such a way that our proposed method should give more accuracy 
than other proposed methods.
## METHODOLOGY
**Algorithm:** 
A. Representation by Segments and Sequences: 
The section of a signal between two consecutive extrema of amplitude constitutes a segment. The 
dataset used for our work consists preliminarily of EEG segments. The section comprising segments 
of specific amplitude constitutes a sequence. The time period, magnitude, and orientation of the 
segments help in its characterization. The difficulty arises when a noise of small amplitude is 
superimposed on waves of longer duration, as the latter does not appear as one segment after 
decomposition. To reduce the noises of small amplitude, we propose a method to eliminate 
overriding waves by computing a minimum difference between consecutive maxima and minima. 
A segment having an amplitude greater than that of the previous segment is not included in the 
sequence and a segment having lesser magnitude with respect to the previous segment is included 
in the sequence. That is, the sequence terminates when a segment not belonging to it is found. The 
EEG of each channel is transformed into sequences and further work is carried out on the newly 
obtained signal.

B. Epoch based analysis: 
A short-time analysis is performed to extract time and frequency domain features by epoch-based 
analysis of the resulting segmented EEG. Each epoch window length is set equal to the sampling 
frequency, Fs of the dataset. That is, an epoch length of 1-second is taken since it depicts the 
minimum stationary interval of EEG. 1-second epoch length offers a suitable number of samples for 
epoch-based analysis for EEG sampled at 173.61 Hz. Furthermore, it gives adequate 
decomposition depth for effective wavelet analysis. 
C. Feature Extraction: 
Feature extraction is the key step in improving the classification accuracy while reducing the space 
dimension of the non-stationary EEG signals. We classify features in the following domains: 
1. Time domain features: A total number of eleven features are extracted, which are further 
categorized as: 
a. Statistical features: The statistical features extracted for our study from the sequentially 
segmented EEG signal are mean, median, mode, standard deviation, minimum, maximum, 
skewness, and kurtosis. Statistical parameters such as mean, skewness, and kurtosis are 
utilized to extract information on any changes within the distribution and amplitude of the 
signal used. 
b. Non-linear features: Non-linear features viz Hjorth parameter and Hurst exponent are 
extracted. The Hjorth parameter determines the statistical property of the EEG signal using 
three parameters - activity, mobility, and complexity. In this work, we have considered 
mobility and complexity only. The Hurst component provides a measure to perform fractal 
analysis of time series. 
2. Frequency domain features: Due to the non-stationary nature and short-term characteristics 
of the EEG signals, statistical and non-features alone are not sufficient for EEG analysis. Also, 
frequency is considered as the intrinsic characteristic of the EEG signal and it can be of different 
types –rhythmic, arrhythmic, or dysrhythmic. In our work, we have used discrete wavelettransform (DWT) for analysis. Discrete wavelet transform: As the Fourier transform cannot be 
analyzed simultaneously, it is not capable of processing any time-frequency information owing 
to the transient characteristics of the EEG signal. To get rid of this shortcoming, wavelet 
transforms are significantly used to solve various engineering problems involving real life 
challenges. Impulses are the irregular patterns appearing at discrete points in signal and these 
discontinuous sequences are analyzed using wavelet transform. An EEG signal can be divided 
into sub-bands by shifting and scaling the original signal without the loss of any data. 

The signal ‘s’ is decomposed into four levels of detail coefficients: D1, D2, D3, D4, and the rest 
of the signal into approximation coefficient A4 [s = D1 + D2 + D3 + D4 + A4]. The 
seizureactivity is predominant in levels 3 and 4 of the wavelet transforms. Wavelet-based 
features: The frequency distribution of the decomposed signal can be represented by extracting 
the statistical features on approximate and detail coefficients. Seizures in recorded EEG are 
most distinguished in the range 3-25 Hz. The maximum, minimum, mean, and standard 
deviation of wavelet coefficients are extracted for levels 3 and 4 as seizures are most prominent 
in these two levels. Therefore, for each channel of the signal, a total number of 8 values are 
extracted. 
D. Feature Selection: 
The process of feature selection is essential as it reduces the set of extracted features by selecting 
the most prominent features only which further leads to efficient classification. In the present work, 
feature selection is carried out using the statistical method of principal component analysis (PCA). 
Principal component analysis is implemented to reduce the dimensionality of the predictor space by 
eliminating redundant dimensions. Reducing dimensionality can create classification models that 
help prevent overfitting. In this work, the percentage of variance is kept being 95%. The features 
with 95% of the variance are selected to reduce the risk of overfitting without removing useful 
dimensions. 
E. Classification: 
In machine learning, classification is a supervised learning technique wherein the computer program 
learns from the input data and then utilizes to classify new set of data. The classification process for 
differentiating amongst seizure and non-seizure EEG signals is performed using different classifiers. 
Based on the accuracy of classification learner we selected the Ensemble method which is also 
known as RUS boosted Tree which gives 99.9 percentage of accuracy. 
F. Performance measurements: 
In our study, the performance of the proposed classifiers is assessed by calculating sensitivity, 
specificity, and classification accuracy.

## Conclusion: 
Many methods were to train the data using classification learner app which is inbuilt in MATLAB. 
We had extracted the features from the dataset using low pass filter, stat_feat, wave_feat etc function 
which were created to extract the features from the dataset. In stat_feat mean, mode, max, min and 
other inbuilt functions were used to extract the features and wave_feat had DWT functions. Then 
the data was segmented and given to ‘data’ function to be used for training in Classification Learner 
app where all the models were trained using this data and out of which Ensemble RUS Boosted 
Trees had an excellent output of accuracy of 99.9% was obtained. 
## Future Scope: 
In the future, meta-heuristic algorithms can be used to extract the best subset of features. The use of 
Huang-Hilbert transform in place of DWT can also be explored. Combination of wavelet transforms 
can also be explored. This method can be implemented in real-time applications by creating apps or 
websites, this reduces the time and cost. 
